---
phase: 12-agent-first-polish
plan: 03
type: execute
wave: 1
depends_on: []
files_modified: [cancer-cli/src/templates/files/frontend/package.json.tpl, cancer-cli/src/templates/files/frontend/vite.config.ts.tpl, cancer-cli/src/templates/files/frontend/src/main.tsx.tpl, inertia-rs/src/response.rs]
autonomous: true
---

<objective>
Fix Tailwind CSS not working out of the box in scaffolded projects.

Purpose: New projects should have working CSS styling immediately. The current scaffolding creates components with Tailwind classes, but Tailwind isn't properly configured in the frontend build, and the Inertia dev template has no CSS support.

Output: Scaffolded projects render styled components without manual configuration.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Current frontend templates:
@cancer-cli/src/templates/files/frontend/package.json.tpl
@cancer-cli/src/templates/files/frontend/vite.config.ts.tpl
@cancer-cli/src/templates/files/frontend/src/main.tsx.tpl
@cancer-cli/src/templates/files/frontend/src/styles/globals.css.tpl

# Inertia HTML template:
@inertia-rs/src/response.rs (lines 292-321 for dev template)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add Tailwind dependencies to package.json</name>
  <files>cancer-cli/src/templates/files/frontend/package.json.tpl</files>
  <action>
Update package.json.tpl to include Tailwind CSS dependencies:

```json
{
  "devDependencies": {
    "@tailwindcss/vite": "^4.0.0",
    "@types/react": "^18.2.0",
    "@types/react-dom": "^18.2.0",
    "@vitejs/plugin-react": "^4.2.0",
    "tailwindcss": "^4.0.0",
    "typescript": "^5.3.0",
    "vite": "^5.0.0"
  }
}
```

Add `tailwindcss` and `@tailwindcss/vite` to devDependencies. Use Tailwind v4 with the Vite plugin for simplest setup.
  </action>
  <verify>Template includes tailwindcss and @tailwindcss/vite in devDependencies</verify>
  <done>package.json.tpl includes Tailwind dependencies</done>
</task>

<task type="auto">
  <name>Task 2: Configure Tailwind in vite.config.ts</name>
  <files>cancer-cli/src/templates/files/frontend/vite.config.ts.tpl</files>
  <action>
Update vite.config.ts.tpl to include the Tailwind plugin:

```typescript
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'
import tailwindcss from '@tailwindcss/vite'

export default defineConfig({
  plugins: [react(), tailwindcss()],
  server: {
    port: 5173,
    strictPort: true,
    cors: true,
  },
  build: {
    outDir: '../public/assets',
    manifest: true,
    rollupOptions: {
      input: 'src/main.tsx',
    },
  },
})
```

Import and add tailwindcss() to the plugins array.
  </action>
  <verify>Template includes tailwindcss import and plugin</verify>
  <done>vite.config.ts.tpl configures Tailwind plugin</done>
</task>

<task type="auto">
  <name>Task 3: Fix main.tsx CSS import and glob pattern</name>
  <files>cancer-cli/src/templates/files/frontend/src/main.tsx.tpl</files>
  <action>
Update main.tsx.tpl with two fixes:

1. **Import global CSS** - Add `import './styles/globals.css'` for Tailwind

2. **Fix page resolver glob pattern** - The current pattern `./pages/**/*.tsx` doesn't match root-level pages like `Dashboard.tsx`. Change to array pattern:

```typescript
import { createInertiaApp } from '@inertiajs/react'
import { createRoot } from 'react-dom/client'
import axios from 'axios'
import './styles/globals.css'

// Configure axios defaults for CSRF protection
axios.defaults.headers.common['X-Requested-With'] = 'XMLHttpRequest'

// Get CSRF token from meta tag and set as default header
const csrfToken = document.querySelector('meta[name="csrf-token"]')?.getAttribute('content')
if (csrfToken) {
  axios.defaults.headers.common['X-CSRF-TOKEN'] = csrfToken
}

createInertiaApp({
  resolve: (name) => {
    // Match both root-level and nested page components
    const pages = import.meta.glob(['./pages/*.tsx', './pages/**/*.tsx'], { eager: true })
    return pages[`./pages/${name}.tsx`]
  },
  setup({ el, App, props }) {
    createRoot(el).render(<App {...props} />)
  },
})
```

The glob array `['./pages/*.tsx', './pages/**/*.tsx']` ensures both:
- Root pages: `pages/Dashboard.tsx`, `pages/Home.tsx`
- Nested pages: `pages/auth/Login.tsx`, `pages/settings/Profile.tsx`
  </action>
  <verify>Template includes globals.css import AND array glob pattern</verify>
  <done>main.tsx.tpl imports CSS and resolves all page locations</done>
</task>

<task type="auto">
  <name>Task 4: Update globals.css for Tailwind v4</name>
  <files>cancer-cli/src/templates/files/frontend/src/styles/globals.css.tpl</files>
  <action>
Update globals.css.tpl for Tailwind v4 syntax:

```css
/* Tailwind CSS v4 */
@import "tailwindcss";

/* Custom global styles below */
```

Tailwind v4 uses `@import "tailwindcss"` instead of the v3 `@tailwind base/components/utilities` directives.
  </action>
  <verify>Template uses Tailwind v4 import syntax</verify>
  <done>globals.css.tpl uses Tailwind v4 syntax</done>
</task>

<task type="auto">
  <name>Task 5: Add Tailwind CDN fallback to Inertia dev template</name>
  <files>inertia-rs/src/response.rs</files>
  <action>
Add Tailwind CDN to the development template as a fallback. While the Vite-processed CSS should work, the CDN ensures styles render even if there are build issues.

Update the development template (around line 294) to include:

```rust
format!(
    r#"<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="csrf-token" content="{}">
    <title>Inertia App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="module">
        import RefreshRuntime from '{}/@react-refresh'
        // ... rest unchanged
```

Add `<script src="https://cdn.tailwindcss.com"></script>` after the title and before the React refresh script.

Note: In production (line 323+), the built CSS file is already linked via `<link rel="stylesheet" href="/assets/main.css">` so no change needed there.
  </action>
  <verify>Development template includes Tailwind CDN script</verify>
  <done>Inertia dev template has Tailwind CDN fallback</done>
</task>

<task type="auto">
  <name>Task 6: Remove CDN from static index.html</name>
  <files>cancer-cli/src/templates/files/frontend/index.html.tpl</files>
  <action>
Now that Tailwind is properly configured via Vite, remove the CDN from index.html.tpl to avoid loading Tailwind twice:

```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{project_title}</title>
  </head>
  <body>
    <div id="app"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
```

Remove the `<script src="https://cdn.tailwindcss.com"></script>` line. Vite will handle CSS via the main.tsx import.
  </action>
  <verify>Template no longer includes Tailwind CDN</verify>
  <done>index.html.tpl uses Vite-processed CSS only</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `cargo build --package cancer-cli` succeeds
- [ ] `cargo build --package inertia-rs` succeeds
- [ ] package.json.tpl includes tailwindcss and @tailwindcss/vite
- [ ] vite.config.ts.tpl imports and uses tailwindcss plugin
- [ ] main.tsx.tpl imports globals.css
- [ ] main.tsx.tpl uses array glob pattern for page resolution
- [ ] globals.css.tpl uses Tailwind v4 syntax
- [ ] Inertia dev template includes Tailwind CDN
- [ ] index.html.tpl does NOT include Tailwind CDN (avoid double-loading)
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- A new scaffolded project has working Tailwind styles out of the box
- Both Vite-served and backend-served pages render styled correctly
</success_criteria>

<output>
After completion, create `.planning/phases/12-agent-first-polish/12-03-SUMMARY.md`
</output>

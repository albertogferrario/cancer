---
phase: 12-agent-first-polish
plan: 02
type: execute
wave: 1
depends_on: []
files_modified: [app/.env.example, framework/Cargo.toml, cancer-queue/Cargo.toml, cancer-cache/Cargo.toml]
autonomous: true
---

<objective>
Create a comprehensive .env.example file documenting all environment variables with their defaults, requirements, and usage examples. Also update outdated dependencies.

Purpose: Self-documenting configuration enables agents to understand exactly what settings exist without reading source code. A well-documented .env.example is the single source of truth for configuration. Clean dependencies prevent future compatibility warnings.

Output: Complete .env.example file in the app directory that agents can copy and customize. Updated redis crate across all packages.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Framework config sources for reference:
# - framework/src/config/providers/app.rs (APP_NAME, APP_DEBUG, APP_URL, APP_ENV)
# - framework/src/config/providers/server.rs (SERVER_HOST, SERVER_PORT, SERVER_MAX_BODY_SIZE)
# - framework/src/database/config.rs (DATABASE_URL, DB_MAX_CONNECTIONS, DB_MIN_CONNECTIONS, DB_CONNECT_TIMEOUT, DB_LOGGING)
# - framework/src/cache/config.rs (REDIS_URL, REDIS_PREFIX)
# - app/src/config/mail.rs (MAIL_DRIVER, MAIL_HOST, MAIL_PORT, MAIL_USERNAME, MAIL_PASSWORD, MAIL_FROM_ADDRESS, MAIL_FROM_NAME)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create comprehensive .env.example</name>
  <files>app/.env.example</files>
  <action>
Create `app/.env.example` with all environment variables, organized by category:

```
#################################################
# Cancer Application Configuration
#################################################
# Copy this file to .env and customize for your environment
# All values shown are defaults (except DATABASE_URL which is required)

#-------------------------------------------------
# Application Settings
#-------------------------------------------------
# Application name (displayed in logs and notifications)
APP_NAME="Cancer Application"

# Environment: local, development, staging, production
APP_ENV=local

# Debug mode (enables detailed errors, disable in production)
APP_DEBUG=true

# Application URL (used for generating links)
APP_URL=http://localhost:8080

#-------------------------------------------------
# Server Settings
#-------------------------------------------------
# Host to bind (0.0.0.0 for all interfaces, 127.0.0.1 for localhost only)
SERVER_HOST=127.0.0.1

# Port to listen on
SERVER_PORT=8080

# Maximum request body size in bytes (default: 10MB)
SERVER_MAX_BODY_SIZE=10485760

#-------------------------------------------------
# Database Settings
#-------------------------------------------------
# Database connection URL (REQUIRED)
# SQLite: DATABASE_URL=sqlite://./database.db
# PostgreSQL: DATABASE_URL=postgres://user:password@localhost:5432/dbname
# MySQL: DATABASE_URL=mysql://user:password@localhost:3306/dbname
DATABASE_URL=sqlite://./database.db

# Connection pool settings
DB_MAX_CONNECTIONS=10
DB_MIN_CONNECTIONS=1
DB_CONNECT_TIMEOUT=30
DB_LOGGING=false

#-------------------------------------------------
# Redis / Cache Settings
#-------------------------------------------------
# Redis URL for caching and queues
REDIS_URL=redis://127.0.0.1:6379

# Cache key prefix (useful for multiple apps sharing Redis)
REDIS_PREFIX=cancer_cache:

#-------------------------------------------------
# Mail Settings
#-------------------------------------------------
# Mail driver: smtp, log (for testing)
MAIL_DRIVER=smtp

# SMTP server settings
MAIL_HOST=localhost
MAIL_PORT=587
MAIL_USERNAME=
MAIL_PASSWORD=

# Default from address and name
MAIL_FROM_ADDRESS=hello@example.com
MAIL_FROM_NAME="Cancer App"

#-------------------------------------------------
# Debug Settings (development only)
#-------------------------------------------------
# Enable debug endpoints at /_cancer/*
# Set to "enabled" to activate, any other value disables
CANCER_DEBUG_ENDPOINTS=enabled
```

Use standard shell comment format. Group related variables. Show defaults inline. Mark required variables clearly.
  </action>
  <verify>cat app/.env.example shows all expected sections</verify>
  <done>.env.example exists with all environment variables documented</done>
</task>

<task type="auto">
  <name>Task 2: Add .env.example to version control</name>
  <files>app/.gitignore</files>
  <action>
Verify .env.example will be tracked (not ignored) while .env remains ignored.

Check if app/.gitignore exists. If it does, ensure:
- `.env` is listed (ignored)
- `.env.example` is NOT listed (tracked)

If app/.gitignore doesn't exist, check root .gitignore for the same.

Typically .env.example should already be tracked (it's not a secret), but verify the pattern doesn't accidentally exclude it (e.g., `.env*` would exclude both).
  </action>
  <verify>git check-ignore app/.env.example returns no output (file is NOT ignored)</verify>
  <done>.env.example will be committed to version control</done>
</task>

<task type="auto">
  <name>Task 3: Upgrade redis dependency to fix future-incompat warning</name>
  <files>framework/Cargo.toml, cancer-queue/Cargo.toml, cancer-cache/Cargo.toml</files>
  <action>
Upgrade redis crate from 0.25 to 0.27 to fix future-incompatibility warning:
"redis v0.25.4 contains code that will be rejected by a future version of Rust"

Current state:
- framework/Cargo.toml: redis = { version = "0.25", ... }
- cancer-queue/Cargo.toml: redis = { version = "0.25", ... }
- cancer-cache/Cargo.toml: redis = { version = "0.25", ... }
- cancer-mcp/Cargo.toml: redis = "0.27" (already updated)

Update each to version "0.27" while preserving existing features:

1. framework/Cargo.toml:
   ```toml
   redis = { version = "0.27", features = ["tokio-comp", "connection-manager"] }
   ```

2. cancer-queue/Cargo.toml:
   ```toml
   redis = { version = "0.27", features = ["tokio-comp", "connection-manager"] }
   ```

3. cancer-cache/Cargo.toml:
   ```toml
   redis = { version = "0.27", features = ["tokio-comp", "connection-manager"], optional = true }
   ```

After updating, run `cargo build` to verify no breaking changes. The redis 0.27 API should be compatible.
  </action>
  <verify>cargo build --all passes without future-incompat warning for redis</verify>
  <done>All packages use redis 0.27, no future-incompatibility warnings</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `app/.env.example` exists with all documented variables
- [ ] All variable categories are represented (App, Server, Database, Redis, Mail, Debug)
- [ ] Each variable has a comment explaining its purpose
- [ ] Defaults are shown inline where applicable
- [ ] Required variables are clearly marked
- [ ] File is not gitignored
- [ ] All packages use redis 0.27
- [ ] `cargo build --all` shows no future-incompat warnings
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Agents can copy .env.example to .env and have a working configuration
- All environment variables used by the framework are documented
</success_criteria>

<output>
After completion, create `.planning/phases/12-agent-first-polish/12-02-SUMMARY.md`
</output>

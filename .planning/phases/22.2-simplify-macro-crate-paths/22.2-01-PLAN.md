---
phase: 22.2-simplify-macro-crate-paths
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - ferro-macros/src/crate_path.rs
  - ferro-macros/src/lib.rs
  - ferro-macros/src/injectable.rs
  - ferro-macros/src/test_macro.rs
  - ferro-macros/src/service.rs
  - ferro-macros/src/redirect.rs
  - ferro-macros/src/inertia.rs
  - ferro-macros/src/domain_error.rs
  - ferro-macros/src/cancer_test.rs
  - ferro-macros/Cargo.toml
  - docs/src/getting-started/installation.md
autonomous: true
---

<objective>
Remove over-engineered `proc-macro-crate` solution and hardcode `ferro::` directly in all proc macros.

Purpose: Phase 22.1 added proc-macro-crate for dynamic crate name detection. This was over-engineering - users should use `ferro` as the dependency name. Hardcoding `::ferro` is simpler and sufficient.

Output: All macros use hardcoded `::ferro` path, proc-macro-crate dependency removed, documentation simplified.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/STATE.md
@.planning/ROADMAP.md
@ferro-macros/src/crate_path.rs
@ferro-macros/src/lib.rs
</context>

<tasks>
<task type="auto">
  <name>Task 1: Remove crate_path module</name>
  <files>ferro-macros/src/crate_path.rs, ferro-macros/src/lib.rs</files>
  <action>
    1. Delete ferro-macros/src/crate_path.rs entirely
    2. In ferro-macros/src/lib.rs:
       - Remove `mod crate_path;` declaration
       - Remove `pub(crate) use crate_path::ferro_crate;` line
  </action>
  <verify>cargo check -p ferro-macros shows "cannot find function ferro_crate" errors (expected - will fix in next task)</verify>
  <done>crate_path.rs deleted, lib.rs updated, ferro_crate function no longer exists</done>
</task>

<task type="auto">
  <name>Task 2: Update all macro files to use hardcoded path</name>
  <files>ferro-macros/src/injectable.rs, ferro-macros/src/test_macro.rs, ferro-macros/src/service.rs, ferro-macros/src/redirect.rs, ferro-macros/src/inertia.rs, ferro-macros/src/domain_error.rs, ferro-macros/src/cancer_test.rs</files>
  <action>
    In each file:
    1. Remove `use crate::ferro_crate;` import
    2. Replace pattern `let ferro = ferro_crate();` with `let ferro = quote!(::ferro);`

    The `#ferro::` usage in quote blocks stays unchanged - it references the local `ferro` variable.

    Files to update (7 total):
    - injectable.rs
    - test_macro.rs
    - service.rs
    - redirect.rs
    - inertia.rs
    - domain_error.rs
    - cancer_test.rs
  </action>
  <verify>cargo check -p ferro-macros compiles without errors</verify>
  <done>All 7 macro files use hardcoded `quote!(::ferro)` instead of `ferro_crate()`</done>
</task>

<task type="auto">
  <name>Task 3: Remove proc-macro-crate dependency</name>
  <files>ferro-macros/Cargo.toml</files>
  <action>
    Remove the line: `proc-macro-crate = "3"`

    Keep all other dependencies unchanged.
  </action>
  <verify>cargo check -p ferro-macros still compiles (no unused import warnings)</verify>
  <done>proc-macro-crate dependency removed from Cargo.toml</done>
</task>

<task type="auto">
  <name>Task 4: Remove flexible naming documentation</name>
  <files>docs/src/getting-started/installation.md</files>
  <action>
    Remove the "Dependency Naming" section (lines 83-114) which documents:
    - Standard naming
    - With Alias pattern
    - Legacy Name pattern

    Keep everything else in the file. The documentation should end at "AI Development Setup" section.
  </action>
  <verify>cat docs/src/getting-started/installation.md shows no "Dependency Naming" section</verify>
  <done>Documentation no longer mentions flexible dependency naming</done>
</task>

<task type="auto">
  <name>Task 5: Full verification</name>
  <files>None (verification only)</files>
  <action>
    1. Run cargo fmt --check on ferro-macros
    2. Run cargo clippy -p ferro-macros
    3. Run cargo test -p ferro-macros
    4. Run cargo build on app/ sample to verify macros work end-to-end

    Fix any issues found.
  </action>
  <verify>All commands pass without errors or warnings</verify>
  <done>ferro-macros builds, tests pass, sample app compiles with hardcoded ferro:: paths</done>
</task>
</tasks>

<verification>
Before declaring plan complete:
- [ ] crate_path.rs deleted
- [ ] All 7 macro files updated to use `quote!(::ferro)`
- [ ] proc-macro-crate removed from Cargo.toml
- [ ] Documentation section removed
- [ ] cargo fmt --check passes
- [ ] cargo clippy -p ferro-macros passes
- [ ] cargo test -p ferro-macros passes
- [ ] Sample app builds successfully
</verification>

<success_criteria>
- proc-macro-crate dependency completely removed
- All macros generate `::ferro::` paths directly
- No dynamic crate detection code remains
- Documentation reflects simplified approach
- All tests pass
</success_criteria>

<output>
After completion, create `.planning/phases/22.2-simplify-macro-crate-paths/SUMMARY-22.2-01.md`
</output>
